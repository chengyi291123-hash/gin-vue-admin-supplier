/*! 
 Build based on gin-vue-admin 
 Time : 1764067928000 */
import{g as e,f as l,d as a,c as t,u}from"./087AC4D233B64EB0sysDictionaryDetail.DElXkv4_.js";import{N as s,a as i,U as r,g as o,ae as n,c as d,o as c,b as p,f as v,a8 as y,i as m,w as f,h as b,q as D,b6 as w,t as h,ab as g,b8 as I,E as V,k as _}from"./087AC4D233B64EB0index.CKMyeZDq.js";const k={class:"gva-table-box"},x={class:"gva-btn-list justify-between flex items-center"},C={class:"flex items-center gap-2"},U={class:"flex justify-between items-center"},B={class:"text-lg"},j=Object.assign({name:"SysDictionaryDetail"},{__name:"sysDictionaryDetail",props:{sysDictionaryID:{type:Number,default:0}},setup(j){const q=s(),E=i(""),S=j,z=i({label:null,value:null,status:!0,sort:null,parentID:null}),A=i({label:[{required:!0,message:"请输入展示值",trigger:"blur"}],value:[{required:!0,message:"请输入字典值",trigger:"blur"}],sort:[{required:!0,message:"排序标记",trigger:"blur"}]}),K=i([]),M={value:"ID",label:"label",children:"children",checkStrictly:!0,emitPath:!1},N=async()=>{if(S.sysDictionaryID)try{const l=await e({sysDictionaryID:S.sysDictionaryID});0===l.code&&(K.value=l.data.list||[])}catch(l){V.error("获取层级数据失败")}},T={ID:null,label:"无父级（根级）"};N();const F=i(""),O=i(!1),P=e=>{z.value.parentID=e},W=()=>{O.value=!1,z.value={label:null,value:null,status:!0,sort:null,parentID:null,sysDictionaryID:S.sysDictionaryID}},G=i(null),H=async()=>{G.value.validate(async e=>{if(z.value.sysDictionaryID=S.sysDictionaryID,!e)return;let l;switch(F.value){case"create":default:l=await t(z.value);break;case"update":l=await u(z.value)}0===l.code&&(V({type:"success",message:"创建/更改成功"}),W(),await N())})},J=()=>{F.value="create",z.value.parentID=null,G.value&&G.value.clearValidate(),O.value=!0},L=()=>{E.value="",N()},Q=()=>{},R=e=>{"Enter"===e.key&&""!==E.value.trim()&&N()};return r(()=>S.sysDictionaryID,()=>{N()}),(e,t)=>{const u=o("el-button"),s=o("el-input"),i=o("el-table-column"),r=o("el-table"),j=o("el-cascader"),X=o("el-form-item"),Y=o("el-switch"),Z=o("el-input-number"),$=o("el-form"),ee=o("el-drawer"),le=n("click-outside");return c(),d("div",null,[p("div",k,[p("div",x,[t[10]||(t[10]=p("span",{class:"text font-bold"},"字典详细内容",-1)),p("div",C,[y((c(),m(s,{placeholder:"搜索展示值",modelValue:E.value,"onUpdate:modelValue":t[0]||(t[0]=e=>E.value=e),clearable:"",class:"!w-64",onClear:L,"prefix-icon":D(w),onKeydown:R},{append:f(()=>[v(u,{type:E.value?"primary":"info",onClick:N},{default:f(()=>[...t[8]||(t[8]=[b("搜索",-1)])]),_:1},8,["type"])]),_:1},8,["modelValue","prefix-icon"])),[[le,Q]]),v(u,{type:"primary",icon:"plus",onClick:J},{default:f(()=>[...t[9]||(t[9]=[b(" 新增字典项 ",-1)])]),_:1})])]),v(r,{data:K.value,style:{width:"100%"},"tooltip-effect":"dark","tree-props":{children:"children"},"row-key":"ID","default-expand-all":""},{default:f(()=>[v(i,{type:"selection",width:"55"}),v(i,{align:"left",label:"展示值",prop:"label","min-width":"240"}),v(i,{align:"left",label:"字典值",prop:"value"}),v(i,{align:"left",label:"扩展值",prop:"extend"}),v(i,{align:"left",label:"日期",width:"180"},{default:f(e=>[b(h(D(g)(e.row.CreatedAt)),1)]),_:1}),v(i,{align:"left",label:"层级",prop:"level",width:"80"}),v(i,{align:"left",label:"启用状态",prop:"status",width:"120"},{default:f(e=>[b(h(D(I)(e.row.status)),1)]),_:1}),v(i,{align:"left",label:"排序标记",prop:"sort",width:"120"}),v(i,{align:"left",label:"操作","min-width":D(q).operateMinWith},{default:f(e=>[v(u,{type:"success",link:"",icon:"plus",onClick:l=>{return a=e.row,F.value="create",z.value={label:null,value:null,status:!0,sort:null,parentID:a.ID,sysDictionaryID:S.sysDictionaryID},G.value&&G.value.clearValidate(),void(O.value=!0);var a}},{default:f(()=>[...t[11]||(t[11]=[b(" 添加子项 ",-1)])]),_:1},8,["onClick"]),v(u,{type:"primary",link:"",icon:"edit",onClick:a=>(async e=>{G.value&&G.value.clearValidate();const a=await l({ID:e.ID});F.value="update",0===a.code&&(z.value=a.data.reSysDictionaryDetail,O.value=!0)})(e.row)},{default:f(()=>[...t[12]||(t[12]=[b(" 变更 ",-1)])]),_:1},8,["onClick"]),v(u,{type:"primary",link:"",icon:"delete",onClick:l=>(async e=>{_.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{0===(await a({ID:e.ID})).code&&(V({type:"success",message:"删除成功"}),1===tableData.value.length&&page.value>1&&page.value--,await N())})})(e.row)},{default:f(()=>[...t[13]||(t[13]=[b(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1},8,["min-width"])]),_:1},8,["data"])]),v(ee,{modelValue:O.value,"onUpdate:modelValue":t[7]||(t[7]=e=>O.value=e),size:D(q).drawerSize,"show-close":!1,"before-close":W},{header:f(()=>[p("div",U,[p("span",B,h("create"===F.value?"添加字典项":"修改字典项"),1),p("div",null,[v(u,{onClick:W},{default:f(()=>[...t[14]||(t[14]=[b(" 取 消 ",-1)])]),_:1}),v(u,{type:"primary",onClick:H},{default:f(()=>[...t[15]||(t[15]=[b(" 确 定 ",-1)])]),_:1})])])]),default:f(()=>[v($,{ref_key:"drawerForm",ref:G,model:z.value,rules:A.value,"label-width":"110px"},{default:f(()=>[v(X,{label:"父级字典项",prop:"parentID"},{default:f(()=>[v(j,{modelValue:z.value.parentID,"onUpdate:modelValue":t[1]||(t[1]=e=>z.value.parentID=e),options:[T,...K.value],props:M,placeholder:"请选择父级字典项（可选）",clearable:"",filterable:"",style:{width:"100%"},onChange:P},null,8,["modelValue","options"])]),_:1}),v(X,{label:"展示值",prop:"label"},{default:f(()=>[v(s,{modelValue:z.value.label,"onUpdate:modelValue":t[2]||(t[2]=e=>z.value.label=e),placeholder:"请输入展示值",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),v(X,{label:"字典值",prop:"value"},{default:f(()=>[v(s,{modelValue:z.value.value,"onUpdate:modelValue":t[3]||(t[3]=e=>z.value.value=e),placeholder:"请输入字典值",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),v(X,{label:"扩展值",prop:"extend"},{default:f(()=>[v(s,{modelValue:z.value.extend,"onUpdate:modelValue":t[4]||(t[4]=e=>z.value.extend=e),placeholder:"请输入扩展值",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),v(X,{label:"启用状态",prop:"status",required:""},{default:f(()=>[v(Y,{modelValue:z.value.status,"onUpdate:modelValue":t[5]||(t[5]=e=>z.value.status=e),"active-text":"开启","inactive-text":"停用"},null,8,["modelValue"])]),_:1}),v(X,{label:"排序标记",prop:"sort"},{default:f(()=>[v(Z,{modelValue:z.value.sort,"onUpdate:modelValue":t[6]||(t[6]=e=>z.value.sort=e),modelModifiers:{number:!0},placeholder:"排序标记"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","size"])])}}});export{j as default};
